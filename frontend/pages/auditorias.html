<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auditorías | Auditorías ISO 9001</title>
  <link rel="stylesheet" href="../assets/styles.css">
  <script src="../assets/auth.js"></script>
</head>
<body>
  <main class="wizard-layout" style="min-height:90vh;background:linear-gradient(120deg,#e3f2fd 0%,#bbdefb 100%);padding:48px 36px;">
  <aside class="aside-card" style="position:sticky;top:40px;align-self:flex-start;min-width:260px;max-width:320px;display:flex;flex-direction:column;align-items:center;background:#fff;border-radius:24px;box-shadow:0 8px 32px rgba(44,62,80,0.10);padding:36px 22px 28px 22px;margin-top:40px;">
      <h1 style="color:#218838;font-size:2.1rem;font-weight:800;letter-spacing:1px;margin-bottom:24px;text-align:center;">Auditorías</h1>
      <a href="dashboard.html" class="dashboard-btn" id="volverPanel" style="margin-bottom:0;width:100%;">Volver al Panel</a>
    </aside>
  <div class="wizard-container" style="width:100%;margin:auto;box-shadow:0 8px 32px rgba(44,62,80,0.15);border-radius:28px;padding:48px 36px 36px 36px;">
  <div class="wizard-progress" style="display:flex;align-items:center;gap:16px;margin-bottom:36px;justify-content:center;">
  <div class="wizard-step active">1</div>
  <div class="wizard-bar"></div>
  <div class="wizard-step">2</div>
  <div class="wizard-bar"></div>
  <div class="wizard-step">3</div>
  <div class="wizard-bar"></div>
  <div class="wizard-step">4</div>
  <div class="wizard-bar"></div>
  <div class="wizard-step">5</div>
  <div class="wizard-bar"></div>
  <div class="wizard-step">6</div>
      </div>
      <div id="wizard-steps">
        <section class="wizard-step-content" id="step1">
          <h2>Paso 1: Registrar nueva auditoría</h2>
          <form id="formAuditoria" class="form-panel-right">
            <input id="empresa_id" name="empresa_id" type="number" placeholder="ID Auditoría / Empresa" required>
            <input id="fecha_auditoria" name="fecha_auditoria" type="date" required>
            <input id="auditor_id" name="auditor_id" type="number" placeholder="ID Auditor" required>
            <select id="tipo_verificacion" name="tipo_verificacion" required>
              <option value="I">I</option>
              <option value="II">II</option>
            </select>
            <input id="observacionesPaso1" name="observaciones_paso1" type="text" placeholder="Observaciones">
            <select id="resultado" name="resultado" required>
              <option value="Aprobado">Aprobado</option>
              <option value="No Aprobado">No Aprobado</option>
              <option value="Pendiente">Pendiente</option>
            </select>
            <input type="text" name="registro_fecha" id="registroFecha" readonly placeholder="Fecha y hora de registro">
            <div style="display:flex;justify-content:flex-end;gap:12px;margin-top:18px;">
              <button type="button" id="nextStep1" class="dashboard-btn">Siguiente</button>
            </div>
          </form>
        </section>
        <section class="wizard-step-content" id="step2" style="display:none;">
          <h2>Paso 2: Seleccionar criterios y checklist</h2>
          <p>Selecciona los criterios y puntos de la norma ISO 9001 que serán evaluados en esta auditoría.</p>
          <div style="margin-bottom:18px;">
            <table style="width:100%;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(44,62,80,0.04);margin-bottom:16px;">
              <thead>
                <tr>
                  <th>Ítem</th>
                  <th>Descripción</th>
                  <th>Seleccionar</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>4.1</td><td>Contexto de la organización</td><td><input name="criterio_4_1" type="checkbox"></td></tr>
                <tr><td>5.1</td><td>Liderazgo</td><td><input name="criterio_5_1" type="checkbox"></td></tr>
                <tr><td>6.1</td><td>Planificación</td><td><input name="criterio_6_1" type="checkbox"></td></tr>
                <tr><td>7.1</td><td>Apoyo</td><td><input name="criterio_7_1" type="checkbox"></td></tr>
                <tr><td>8.1</td><td>Operación</td><td><input name="criterio_8_1" type="checkbox"></td></tr>
                <tr><td>9.1</td><td>Evaluación del desempeño</td><td><input name="criterio_9_1" type="checkbox"></td></tr>
                <tr><td>10.1</td><td>Mejora</td><td><input name="criterio_10_1" type="checkbox"></td></tr>
              </tbody>
            </table>
            <h3 style="margin-top:24px;">Listado de criterios</h3>
            <table style="width:100%;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(44,62,80,0.04);margin-bottom:16px;">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nombre</th>
                  <th>Descripción</th>
                  <th>Cláusula ISO</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>1</td><td>Control de documentos</td><td>Gestión de documentos y registros</td><td>7.5</td></tr>
                <tr><td>2</td><td>Competencia</td><td>Formación y habilidades del personal</td><td>7.2</td></tr>
                <tr><td>3</td><td>Seguimiento y medición</td><td>Evaluación de procesos</td><td>9.1</td></tr>
                <!-- Puedes agregar más criterios aquí -->
              </tbody>
            </table>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <button type="button" id="prevStep2" class="dashboard-btn">Anterior</button>
            <button type="button" id="nextStep2" class="dashboard-btn">Siguiente</button>
          </div>
        </section>
        <section class="wizard-step-content" id="step3" style="display:none;">
          <h2>Paso 3: Registrar resultados y evidencias</h2>
          <p>Para cada criterio, registra si cumple, observaciones y adjunta evidencias.</p>
          <table id="resultadosCriterios" style="width:100%;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(44,62,80,0.04);margin-bottom:16px;">
            <thead>
              <tr>
                <th>ID</th>
                <th>Criterio</th>
                <th>Cumplimiento</th>
                <th>Evidencia</th>
                <th>Observaciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Control de documentos</td>
                <td>
                  <select name="cumplimiento_1">
                    <option value="Cumple">Cumple</option>
                    <option value="No Cumple">No Cumple</option>
                    <option value="Parcial">Parcial</option>
                  </select>
                </td>
                <td><input name="evidencia_1" type="text" placeholder="Evidencia"></td>
                <td><input name="observaciones_1" type="text" placeholder="Observaciones"></td>
              </tr>
              <tr>
                <td>2</td>
                <td>Competencia</td>
                <td>
                  <select name="cumplimiento_2">
                    <option value="Cumple">Cumple</option>
                    <option value="No Cumple">No Cumple</option>
                    <option value="Parcial">Parcial</option>
                  </select>
                </td>
                <td><input name="evidencia_2" type="text" placeholder="Evidencia"></td>
                <td><input name="observaciones_2" type="text" placeholder="Observaciones"></td>
              </tr>
              <tr>
                <td>3</td>
                <td>Seguimiento y medición</td>
                <td>
                  <select name="cumplimiento_3">
                    <option value="Cumple">Cumple</option>
                    <option value="No Cumple">No Cumple</option>
                    <option value="Parcial">Parcial</option>
                  </select>
                </td>
                <td><input name="evidencia_3" type="text" placeholder="Evidencia"></td>
                <td><input name="observaciones_3" type="text" placeholder="Observaciones"></td>
              </tr>
              <!-- Puedes agregar más resultados aquí -->
            </tbody>
          </table>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <button type="button" id="prevStep3" class="dashboard-btn">Anterior</button>
            <button type="button" id="nextStep3" class="dashboard-btn">Siguiente</button>
          </div>
        </section>
        <section class="wizard-step-content" id="step4" style="display:none;">
          <h2>Paso 4: Hallazgos y acciones de mejora</h2>
          <p>Para registrar hallazgos y acciones de mejora, debes ir al módulo correspondiente.</p>
          <div style="display:flex;justify-content:center;gap:18px;margin-bottom:18px;">
            <a href="acciones-mejora.html" class="dashboard-btn" target="_blank">Ir a Acciones de Mejora</a>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <button type="button" id="prevStep4" class="dashboard-btn">Anterior</button>
            <button type="button" id="nextStep4" class="dashboard-btn">Ya registré y quiero continuar</button>
          </div>
        </section>
        <section class="wizard-step-content" id="step5" style="display:none;">
          <h2>Paso 5: Capacitaciones e implementaciones</h2>
          <p>Para registrar capacitaciones e implementaciones, debes ir a los módulos correspondientes.</p>
          <div style="display:flex;justify-content:center;gap:18px;margin-bottom:18px;">
            <a href="capacitaciones.html" class="dashboard-btn" target="_blank">Ir a Capacitaciones</a>
            <a href="implementaciones.html" class="dashboard-btn" target="_blank">Ir a Implementaciones</a>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <button type="button" id="prevStep5" class="dashboard-btn">Anterior</button>
            <button type="button" id="nextStep5" class="dashboard-btn">Ya registré y quiero continuar</button>
          </div>
        </section>
        <section class="wizard-step-content" id="step6" style="display:none;">
          <h2>Paso 6: Cierre y resumen</h2>
          <p>Revisa el resumen de la auditoría antes de finalizar.</p>
          <textarea id="resumenFinal" placeholder="Resumen final..." style="width:100%;height:80px;"></textarea>
          <div id="wizardNotification" style="margin:12px 0;min-height:20px;color:#0b5; font-weight:600;"></div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <button type="button" id="prevStep6" class="dashboard-btn">Anterior</button>
            <button type="button" id="finishWizard" class="dashboard-btn">Finalizar auditoría</button>
          </div>
        </section>
      </div>
    </div>
  </main>
  <script src="../assets/auditorias.js"></script>
  <script>
    // Wizard navigation logic
    function setStep(step) {
      for (let i = 1; i <= 6; i++) {
        document.getElementById('step'+i).style.display = (i === step) ? 'block' : 'none';
        document.querySelectorAll('.wizard-step')[i-1].classList.toggle('active', i === step);
      }
    }
    // Registrar fecha y hora automática al crear auditoría
    document.getElementById('nextStep1').onclick = function() {
      var fecha = new Date();
      document.getElementById('registroFecha').value = fecha.toLocaleString();
      setStep(2);
    };
    document.getElementById('prevStep2').onclick = function() { setStep(1); };
    document.getElementById('nextStep2').onclick = function() { setStep(3); };
    document.getElementById('prevStep3').onclick = function() { setStep(2); };
    document.getElementById('nextStep3').onclick = function() { setStep(4); };
    document.getElementById('prevStep4').onclick = function() { setStep(3); };
    document.getElementById('nextStep4').onclick = function() { setStep(5); };
    document.getElementById('prevStep5').onclick = function() { setStep(4); };
    document.getElementById('nextStep5').onclick = function() { setStep(6); };
    document.getElementById('prevStep6').onclick = function() { setStep(5); };
    document.getElementById('finishWizard').onclick = function() {
      alert('¡Auditoría finalizada y registrada!');
      setStep(1);
      document.getElementById('formAuditoria').reset();
    };
    setStep(1);
  </script>
  <!-- El CSS se movió a assets/styles.css -->
  <script>
    document.getElementById('volverPanel').onclick = function(e) {
      e.preventDefault();
      window.location.href = 'dashboard.html';
    };
  </script>
</body>
</html>
